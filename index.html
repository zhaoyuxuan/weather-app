<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/styles.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <title>Weather App</title>
  </head>
  <body>
    <div class="container-fluid">
      <div class = "row justify-content-center" id ="title">
        WEATHER APP
      </div>

      <div class = "row justify-content-center" >
        <input type="text" id ="inputcity" placeholder="Enter City" list="cityList" onkeydown="check()"></input>
        <datalist id="cityList"></datalist>
  
        </script>

      </div>


    </div>
       
      
  </body>


<script type="text/javascript">
  function getcityoption(){
    var formData = new FormData();
    // formData.set("userInput", userInput);
     $.ajax({
            type: "POST",
            url: "/citydata",
            data: formData,
            contentType: false,
            processData: false,
            success: function(response) {
                localStorage.setItem("citydata",JSON.stringify(response));
            }
        });
  }
  window.onload = getcityoption;
</script>
<script type="text/javascript">

  function check(){
    var citydata = JSON.parse(localStorage.citydata);
    
    $( "#inputcity").autocomplete({
      source: function(request, response) {
        var results = $.ui.autocomplete.filter(citydata, request.term);
        response(results.slice(0, 10));
      
    }
      
    });

  
  }
  $.ui.autocomplete.filter = function (array, term) {
    var matcher = new RegExp("^" + $.ui.autocomplete.escapeRegex(term), "i");
    return $.grep(array, function (value) {
        return matcher.test(value.label || value.value || value);
    });

};
$("#inputcity").on('keyup', function (e) {
    if (e.keyCode == 13) {
        // Do something
    }
});
</script>
</html>

